{"ast":null,"code":"import * as i0 from \"@angular/core\";\nconst STORAGE_KEY = 'crud_usuarios';\nexport let UsuariosService = /*#__PURE__*/(() => {\n  class UsuariosService {\n    constructor() {\n      this.usuarios = this.loadUsuarios();\n    }\n    getUsuarios() {\n      return [...this.usuarios].sort((a, b) => a.id - b.id);\n    }\n    createUsuario(payload) {\n      const nextId = this.usuarios.length ? Math.max(...this.usuarios.map(u => u.id)) + 1 : 1;\n      const nuevo = {\n        id: nextId,\n        ...payload\n      };\n      this.usuarios.push(nuevo);\n      this.saveUsuarios();\n      return nuevo;\n    }\n    updateUsuario(id, payload) {\n      const index = this.usuarios.findIndex(usuario => usuario.id === id);\n      if (index < 0) {\n        return false;\n      }\n      this.usuarios[index] = {\n        id,\n        ...payload\n      };\n      this.saveUsuarios();\n      return true;\n    }\n    deleteUsuario(id) {\n      const initialLength = this.usuarios.length;\n      this.usuarios = this.usuarios.filter(usuario => usuario.id !== id);\n      const changed = this.usuarios.length !== initialLength;\n      if (changed) {\n        this.saveUsuarios();\n      }\n      return changed;\n    }\n    findByCredentials(username, password) {\n      return this.usuarios.find(usuario => usuario.username === username && usuario.password === password) ?? null;\n    }\n    existsUsername(username, excludeId) {\n      return this.usuarios.some(usuario => usuario.username === username && usuario.id !== excludeId);\n    }\n    saveUsuarios() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.usuarios));\n    }\n    loadUsuarios() {\n      const raw = localStorage.getItem(STORAGE_KEY);\n      if (!raw) {\n        const seedUsers = [{\n          id: 1,\n          nombre: 'Admin',\n          apellido: 'General',\n          fechaIngreso: '2025-01-01',\n          username: 'admin',\n          password: 'admin123'\n        }];\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(seedUsers));\n        return seedUsers;\n      }\n      try {\n        const parsed = JSON.parse(raw);\n        return Array.isArray(parsed) ? parsed : [];\n      } catch {\n        return [];\n      }\n    }\n    static {\n      this.ɵfac = function UsuariosService_Factory(t) {\n        return new (t || UsuariosService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: UsuariosService,\n        factory: UsuariosService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return UsuariosService;\n})();","map":{"version":3,"names":["STORAGE_KEY","UsuariosService","constructor","usuarios","loadUsuarios","getUsuarios","sort","a","b","id","createUsuario","payload","nextId","length","Math","max","map","u","nuevo","push","saveUsuarios","updateUsuario","index","findIndex","usuario","deleteUsuario","initialLength","filter","changed","findByCredentials","username","password","find","existsUsername","excludeId","some","localStorage","setItem","JSON","stringify","raw","getItem","seedUsers","nombre","apellido","fechaIngreso","parsed","parse","Array","isArray","factory","ɵfac","providedIn"],"sources":["C:\\Users\\marci\\OneDrive\\Documentos\\GitHub\\crud\\src\\app\\services\\usuarios.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Usuario } from '../models/usuario.model';\r\n\r\nconst STORAGE_KEY = 'crud_usuarios';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class UsuariosService {\r\n  private usuarios: Usuario[] = this.loadUsuarios();\r\n\r\n  getUsuarios(): Usuario[] {\r\n    return [...this.usuarios].sort((a, b) => a.id - b.id);\r\n  }\r\n\r\n  createUsuario(payload: Omit<Usuario, 'id'>): Usuario {\r\n    const nextId = this.usuarios.length ? Math.max(...this.usuarios.map((u) => u.id)) + 1 : 1;\r\n    const nuevo: Usuario = { id: nextId, ...payload };\r\n    this.usuarios.push(nuevo);\r\n    this.saveUsuarios();\r\n    return nuevo;\r\n  }\r\n\r\n  updateUsuario(id: number, payload: Omit<Usuario, 'id'>): boolean {\r\n    const index = this.usuarios.findIndex((usuario) => usuario.id === id);\r\n    if (index < 0) {\r\n      return false;\r\n    }\r\n    this.usuarios[index] = { id, ...payload };\r\n    this.saveUsuarios();\r\n    return true;\r\n  }\r\n\r\n  deleteUsuario(id: number): boolean {\r\n    const initialLength = this.usuarios.length;\r\n    this.usuarios = this.usuarios.filter((usuario) => usuario.id !== id);\r\n    const changed = this.usuarios.length !== initialLength;\r\n    if (changed) {\r\n      this.saveUsuarios();\r\n    }\r\n    return changed;\r\n  }\r\n\r\n  findByCredentials(username: string, password: string): Usuario | null {\r\n    return this.usuarios.find((usuario) => usuario.username === username && usuario.password === password) ?? null;\r\n  }\r\n\r\n  existsUsername(username: string, excludeId?: number): boolean {\r\n    return this.usuarios.some((usuario) => usuario.username === username && usuario.id !== excludeId);\r\n  }\r\n\r\n  private saveUsuarios(): void {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(this.usuarios));\r\n  }\r\n\r\n  private loadUsuarios(): Usuario[] {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (!raw) {\r\n      const seedUsers: Usuario[] = [\r\n        {\r\n          id: 1,\r\n          nombre: 'Admin',\r\n          apellido: 'General',\r\n          fechaIngreso: '2025-01-01',\r\n          username: 'admin',\r\n          password: 'admin123'\r\n        }\r\n      ];\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(seedUsers));\r\n      return seedUsers;\r\n    }\r\n\r\n    try {\r\n      const parsed = JSON.parse(raw) as Usuario[];\r\n      return Array.isArray(parsed) ? parsed : [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}